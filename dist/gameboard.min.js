/*! gameboard - v0.2.0-alpha2 - 11-11-2014 */
udefine("gameboard/assetloader",["root","eventmap","./log"],function(a,b,c){var d=function(a){b.mixin(this,d.prototype),this.assets=a||{},this.files={},this.maxAssets=0,this.assetsLoaded=0,this.percentLoaded=0};return d.prototype.start=function(){if(null!=assets){this.trigger("start");var b=function(){var a=100;currentProgress!==totalSize&&(a=currentProgress/totalSize),self.trigger("progress",a),currentProgress>=totalSize&&self.trigger("complete")},d=function(a){return function(){currentProgress+=a.size,self.assetsLoaded++,b()}},e=function(a){return function(b){c.e("Error while loading "+a.name+": "+b)}};Object.keys(this.assets)>0&&Object.keys(this.assets).forEach(function(b){var f=this.assets[b];if(null==f.files||!Array.isArray(f.files)||0===f.files.length)return!0;self.maxAssets+=f.files.length;for(var g=0,h=f.files.length;h>g;g++)!function(b){if(0===b.type.indexOf("image")){var f=new a.Image;f.onload=d(b),f.onerror=e(b),f.src=b.name}else if(0===b.type.indexOf("audio")){var g=b.name.split(".").pop(),h=new a.Audio;supportedTypes[g]&&h.canPlayType(supportedTypes[g])?(h.addEventListener("canplaythrough",d(b)),h.onerror=e(b),h.src=b.name,h.load()):(c.w("Skipped unsupported audio file ("+supportedTypes[g]+") "+b.name),d(b)())}else c.w("Skipped file "+b.name+": Not an audio or image file")}(f.files[g])},this)}},d}),function(a){"object"==typeof exports?module.exports=a():"function"==typeof window.define&&window.define.amd?window.define("gameboard/bezier-easing",[],a):window.BezierEasing=a()}(function(){function a(a,b,j,k){function l(a,b){return 1-3*b+3*a}function m(a,b){return 3*b-6*a}function n(a){return 3*a}function o(a,b,c){return((l(b,c)*a+m(b,c))*a+n(b))*a}function p(a,b,c){return 3*l(b,c)*a*a+2*m(b,c)*a+n(b)}function q(b,d){for(var e=0;c>e;++e){var f=p(d,a,j);if(0===f)return d;var g=o(d,a,j)-b;d-=g/f}return d}function r(){for(var b=0;g>b;++b)w[b]=o(b*h,a,j)}function s(b,c,d){var g,h,i=0;do h=c+(d-c)/2,g=o(h,a,j)-b,g>0?d=h:c=h;while(Math.abs(g)>e&&++i<f);return h}function t(b){for(var c=0,e=1,f=g-1;e!=f&&w[e]<=b;++e)c+=h;--e;var i=(b-w[e])/(w[e+1]-w[e]),k=c+i*h,l=p(k,a,j);return l>=d?q(b,k):0==l?k:s(b,c,c+h)}function u(){x=!0,(a!=b||j!=k)&&r()}if(4!==arguments.length)throw new Error("BezierEasing requires 4 arguments.");for(var v=0;4>v;++v)if("number"!=typeof arguments[v]||isNaN(arguments[v])||!isFinite(arguments[v]))throw new Error("BezierEasing arguments should be integers.");if(0>a||a>1||0>j||j>1)throw new Error("BezierEasing x values must be in [0, 1] range.");var w=i?new Float32Array(g):new Array(g),x=!1,y=function(c){return x||u(),a===b&&j===k?c:0===c?0:1===c?1:o(t(c),b,k)};y.getControlPoints=function(){return[{x:a,y:b},{x:j,y:k}]};var z="BezierEasing("+[a,b,j,k]+")";return y.toString=function(){return z},y}var b=this,c=4,d=.001,e=1e-7,f=10,g=11,h=1/(g-1),i="Float32Array"in b;return a.css={ease:a(.25,.1,.25,1),linear:a(0,0,1,1),"ease-in":a(.42,0,1,1),"ease-out":a(0,0,.58,1),"ease-in-out":a(.42,0,.58,1)},a}),udefine("gameboard",["gameboard/assetloader","gameboard/input","gameboard/loop","gameboard/log","gameboard/timer"],function(a,b,c,d,e){return{AssetLoader:a,Input:b,Loop:c,Log:d,Timer:e}}),udefine("gameboard/input",["root","eventmap","gameboard/key"],function(a,b,c){var d={};return d.define=c.define,d.key=new b,a.addEventListener("keydown",function(a){d.key.trigger({name:"down",context:c},a.keyCode)},!0),a.addEventListener("keyup",function(a){d.key.trigger({name:"up",context:c},a.keyCode)},!0),d}),udefine("gameboard/key",function(){"use strict";var a={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,escape:27,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222};return a.define=function(b,c){null!=b&&null!=c&&(Object.hasOwnProperty.call(a,b)||("function"==typeof c?Object.defineProperty(a,b,{get:c}):a[b]=c))},a}),define("gameboard/log",["root"],function(a){"use strict";var b=function(){var b={};b.connector=null,b.plugins={},b.plugins.console={e:function(){return a.console&&a.console.error?a.console.error.apply(console,arguments):void 0},w:function(){return a.console&&a.console.warn?a.console.warn.apply(console,arguments):void 0},i:function(){return a.console&&a.console.info?a.console.info.apply(console,arguments):void 0},d:function(){return a.console&&a.console.log?a.console.log.apply(console,arguments):void 0},v:function(){return a.console&&a.console.log?a.console.log.apply(console,arguments):void 0}},b.connector=b.plugins.console,b.logLevelMap={error:["e"],warn:["w","e"],info:["i","w","e"],debug:["d","i","w","e"],verbose:["v","d","i","w","e"]},b.logLevel="verbose";for(var c=["v","d","i","w","e"],d=0,e=c.length;e>d;d++)!function(a){b[a]=function(){b.logLevelMap[b.logLevel].indexOf(a)>=0&&b.connector[a].apply(this,arguments)}}(c[d]);return b}();return b}),udefine("gameboard/loop",["requestanimationframe","eventmap","gameboard/timer"],function(a,b,c){"use strict";var d=new b,e={},f=[];return function(){var b=!0,g=function(){var c;!function g(){a(g);var h=performance.now()||Date.now(),i=h-(c||h);if(c=h,b){f.forEach(function(a){a.tick(h)});for(var j=Object.keys(d.events.listeners),k=0,l=j.length;l>k;k++)!function(a){e[a]||d.trigger(a,i)}(j[k])}}()},h=function(){b=!1},i=function(){d.clear(),e={}},j=function(a,b){d.on(a,b),e[a]=!1},k=function(a){d.off(a),null!=e[a]&&delete e[a]},l=function(a){e[a]=!0},m=function(a){return null==a?void(b=!0):void(e[a]=!1)},n=function(a){var b=new c(a);return f.push(b),b};return{run:g,stop:h,clear:i,on:j,off:k,pause:l,resume:m,createTimer:n}}()}),udefine("clamp",function(){"use strict";var a=function(a,b,c){var d,e,f;return"object"==typeof a&&(d=a,b=d.min,c=d.max,a=d.value),Array.isArray(b)&&(e=b,b=e[0],c=e[1]),null==b&&(b=0),null==c&&(c=1),b>c&&(f=[c,b],b=f[0],c=f[1]),a>=b&&c>=a?a:a>c?c:b};return a}),udefine("inverselerp",["lerp"],function(a){return function(b,c,d){return c-a(b,c,d)}}),udefine("lerp",["clamp"],function(a){return function(b,c,d){var e=a(d,0,1),f=Math.abs(c-b);return 0===f?b:b+f*e}}),function(a){"use strict";define("root",function(){return a})}(this),udefine("gameboard/timer",["eventmap","performance"],function(a,b){var c=function(b){a.mixin(this,c.prototype);var d=this;this.interval=b||1e3,this.startTime=-1,this.active=!1,this.paused=!1;var e=0;this.tick=function(a){d.active&&!d.paused&&(0>=b||(d.trigger("tick",a),a-d.startTime-d.interval>e&&(e=a,d.trigger("interval"))))}};return c.prototype.start=function(){this.active=!0,this.paused=!1,this.startTime=b.now(),this.trigger("start")},c.prototype.pause=function(){this.paused=!0,this.trigger("pause")},c.prototype.unpause=function(){this.paused=!1,this.trigger("unpause")},c.prototype.stop=function(){this.paused=!1,this.active=!1,this.trigger("stop")},c}),udefine("gameboard/tween",["eventmap","gameboard/bezier-easing","gameboard/loop"],function(a,b,c){var d=function(){a.mixin(this,d.prototype),this.target=null};return d.prototype.animate=function(a,d,e,f){var g=this;if(this.target&&"number"==typeof this.target[a]){var h=this.target[a];if(h===d)return this.trigger("start"),void this.trigger("end");f=f||"linear";var i=c.createTimer();i.interval=e,i.on("start",function(){g.trigger("start")}),i.start(),i.on("tick",function(c){var e=b.css[f](c/(i.startTime+i.interval)),j=(d-h)*e;j>d&&(j=d),g.target[a]=j,g.trigger("animate",j)}),i.on("interval",function(){i.stop(),g.target[a]=d,g.trigger("end")})}},d});